```mermaid
flowchart LR
  %% Frontend components
  subgraph Frontend
    Chat[Gradio Chat UI]\n    Chart[Plotly Chart Pane]\n  end

  %% Backend components
  subgraph Backend
    Server[Gradio Python Server]\n    State[Session State Store]\n    Prompt[Prompt Template Engine]\n    GPT[OpenAI GPT-4 API]\n    Renderer[Plotly Rendering Layer]\n  end

  %% Interactions
  Chat -->|User message| Server
  Chart -->|Initial render| Server
  Server -->|Load/Save fig JSON| State
  Server -->|Build prompt| Prompt
  Prompt -->|Send prompt| GPT
  GPT -->|JSON patch| Server
  Server -->|Apply patch| Renderer
  Renderer -->|Updated fig| Chart
  Server -->|Render UI| Chat
  State -->|Persistence| Server
```